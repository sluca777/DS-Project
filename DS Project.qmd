---
title: "DS Project"
author: "Lucas Rapeepat, Ian Stripe"
format: 
  html:
    toc: true
    embed-resources: true
    code-fold: true
    code-line-numbers: true
    code-summary: "SHOW ME THE CODE!"
    code-tools: true
    theme: yeti
editor: visual
---

# Introduction

In the contemporary landscape of American family life, the cost of childcare emerges as a pivotal factor influencing economic stability, parental employment, and, ultimately, child welfare. Access to affordable, quality childcare has been linked to a range of positive outcomes, including increased workforce participation, particularly among women, and enhanced child development. Yet, for many families across the United States, childcare remains a significant financial burden, absorbing a disproportionate share of household income. This project seeks to illuminate the complexities surrounding childcare costs, shedding light on their variability across different geographical regions and over time.

This analysis is anchored in data drawn from the National Database of Childcare Prices, the most comprehensive federal repository of childcare price information at the county level. Spanning from 2008 to 2018, this database offers a granular look at childcare costs across various dimensions: by provider type, the age of children, and county characteristics. The project utilizes two primary data sets: childcare_costs.csv, containing detailed childcare price data, and counties.csv, which provides a suite of county-level attributes. These datasets are unified through the county_fips_code, enabling a holistic examination of how childcare costs correlate with a myriad of socioeconomic factors.

The goal of this project is not merely to chart the ebb and flow of childcare expenses but to understand the broader implications of these costs on families and communities. By employing a robust analytical framework, this study will explore several key questions: How have childcare costs evolved over the last decade? Do these costs exhibit significant variability across states or regions? What socioeconomic variables—such as unemployment rates, median household income, or racial composition—interact most dynamically with childcare expenses?

The answers to these questions promise not only to advance our understanding of childcare economics but also to inform policy discussions aimed at making quality childcare more accessible and affordable. Through a meticulous analysis of available data, this project endeavors to contribute a meaningful voice to the ongoing dialogue about how best to support American families in balancing the demands of work and child-rearing.














# Section 2

```{r}
#Set-up
#| message: false
#| warning: false
library(tidyverse)
```

```{r}
# Load and inspect the datasets
childcare_costs <- read.csv("C:/Users/Lucas Rapeepat/Downloads/childcare_costs.csv")
counties <- read.csv("C:/Users/Lucas Rapeepat/Downloads/counties.csv")
str(childcare_costs)
str(counties)

# Size of data pre-merge
dim(childcare_costs)
dim(counties)


# Merge datasets
combined_data <- childcare_costs |>
  inner_join(counties, by = "county_fips_code")

# Remove missing data
cleaned_data <- combined_data |>
  drop_na()

#Counting Counties
cleaned_data |>
  select(county_name) |>
  n_distinct(na.rm = TRUE)

#Dim Cleaned Data

dim(cleaned_data)
```

## Data Pre-Processing
In the Data Pre-Processing section of our report, we initiated our in-depth analysis with an extensive review of the two core datasets at our disposal: childcare_costs.csv and counties.csv. The childcare_costs file was a rich repository, with tens of thousands of rows encapsulating crucial childcare pricing data. The counties dataset, while not as extensive, provided essential demographic and socioeconomic indicators for each county.

We merged the childcare_costs and counties datasets on the county_fips_code, which acted as a unique identifier for each county, and ensured that only records with matching identifiers in both datasets were retained.

The dimensions of the raw childcare costs data before merging are 34567 by 61, while the dimensions of the counties table are 3144 by 4.
After the merge, the dimensions of the cleaned data are 23342 by 64.

There are 1779 unique counties available for analysis, which we counted from the cleaned and joined dataset.




# Section 3


Descriptive Statistics for childcare and family costs:
```{r}
# Calculate descriptive statistics for the different childcare costs
cleaned_data |>
  select(mcsa, mfccsa) |>
  summarise_all(list(mean = mean, median = median, IQR = IQR), na.rm = TRUE)
```
Grouping highest costs by county

```{r}
cleaned_data |>
  group_by(county_name) |>
  summarize(
    childcare_avg = mean(mcsa, na.rm = TRUE),
    family_avg = mean(mfccsa, na.rm = TRUE)
  ) |>
  arrange(desc(childcare_avg)) |>
  slice_head(n = 5)


  
```



Did childcare costs differ by state (on average)?

```{r}
state_costs <- cleaned_data |>
  group_by(state_name) |>
  summarize(across(starts_with("mc"), mean, na.rm = TRUE))

state_costs

```

How were childcare costs related by race?

```{r}


library(dplyr)

# Calculate weighted averages for each race and childcare type
race_weighted_costs <- cleaned_data |>
  summarize(
    white_infant = weighted.mean(mc_infant, one_race_w, na.rm = TRUE),
    black_infant = weighted.mean(mc_infant, one_race_b, na.rm = TRUE),
    ai_an_infant = weighted.mean(mc_infant, one_race_i, na.rm = TRUE),
    asian_infant = weighted.mean(mc_infant, one_race_a, na.rm = TRUE),
    nh_pi_infant = weighted.mean(mc_infant, one_race_h, na.rm = TRUE),
    other_infant = weighted.mean(mc_infant, one_race_other, na.rm = TRUE),

    white_toddler = weighted.mean(mc_toddler, one_race_w, na.rm = TRUE),
    black_toddler = weighted.mean(mc_toddler, one_race_b, na.rm = TRUE),
    ai_an_toddler = weighted.mean(mc_toddler, one_race_i, na.rm = TRUE),
    asian_toddler = weighted.mean(mc_toddler, one_race_a, na.rm = TRUE),
    nh_pi_toddler = weighted.mean(mc_toddler, one_race_h, na.rm = TRUE),
    other_toddler = weighted.mean(mc_toddler, one_race_other, na.rm = TRUE),

    white_preschool = weighted.mean(mc_preschool, one_race_w, na.rm = TRUE),
    black_preschool = weighted.mean(mc_preschool, one_race_b, na.rm = TRUE),
    ai_an_preschool = weighted.mean(mc_preschool, one_race_i, na.rm = TRUE),
    asian_preschool = weighted.mean(mc_preschool, one_race_a, na.rm = TRUE),
    nh_pi_preschool = weighted.mean(mc_preschool, one_race_h, na.rm = TRUE),
    other_preschool = weighted.mean(mc_preschool, one_race_other, na.rm = TRUE)
  )

# Transform data to have races as rows and childcare cost denominations as columns
race_weighted_costs_long <- race_weighted_costs |>
  pivot_longer(
    everything(),
    names_to = c(".value", "childcare_type"),
    names_pattern = "(.*)_(.*)"
  )
  

race_weighted_costs_long


```

Comparison of Family Care vs Center-Based

```{r}

# Calculate the average costs for center-based and family childcare for each age group
care_cost_comparison <- cleaned_data |>
  summarize(
    avg_center_infant = mean(mc_infant, na.rm = TRUE),
    avg_family_infant = mean(mfcc_infant, na.rm = TRUE),
    avg_center_toddler = mean(mc_toddler, na.rm = TRUE),
    avg_family_toddler = mean(mfcc_toddler, na.rm = TRUE),
    avg_center_preschool = mean(mc_preschool, na.rm = TRUE),
    avg_family_preschool = mean(mfcc_preschool, na.rm = TRUE)
  ) 

care_cost_comparison

```
Childcare Costs related to Poverty Rates?

```{r}
#Lowest 5 Poverty Rates
cleaned_data |>
  select(pr_f, mc_infant, mc_toddler, mc_preschool, mfcc_infant, mfcc_toddler, mfcc_preschool) |>
  arrange(pr_f) |>
  slice_head(n = 5)

#Highest 5 Poverty Rates
cleaned_data |>
  select(pr_f, mc_infant, mc_toddler, mc_preschool, mfcc_infant, mfcc_toddler, mfcc_preschool) |>
  arrange(desc(pr_f)) |>
  slice_head(n = 5)

```

Childcare Costs in Counties with High Service Sector Employment
Determine if counties with a higher proportion of service sector employment see different childcare costs.
```{r}
 cleaned_data |>
  filter(emp_service > median(emp_service, na.rm = TRUE)) |>
  summarise(
    median_cost_infant = median(mc_infant, na.rm = TRUE),
    median_cost_toddler = median(mc_toddler, na.rm = TRUE),
    median_cost_preschool = median(mc_preschool, na.rm = TRUE)
  )

```


# Section 4

Did childcare costs (by age group) on average change over time from 2008 to 2018?
```{r}
cost_trends <- cleaned_data |>
  select(study_year, mc_infant, mc_toddler, mc_preschool) |>
  group_by(study_year) |>
  summarize(across(starts_with("mc"), mean, na.rm = TRUE))

ggplot(cost_trends, aes(x = study_year)) +
  geom_line(aes(y = mc_infant, color = "Infant")) +
  geom_line(aes(y = mc_toddler, color = "Toddler")) +
  geom_line(aes(y = mc_preschool, color = "Preschool")) +
  labs(title = "Childcare Costs Trends from 2008 to 2018",
       x = "Year",
       y = "Average Cost",
       color = "Age Group")
```
This line graph presents the average annual childcare costs for infants, toddlers, and preschoolers from 2008 to 2018. From the graph, it is clear that the average cost for infants was most expensive, and that the older the child gets, the cheaper it is to pay to take care of them. There is also a rising cost over time in general, with the lines following 


How were Childcare costs related to Median Household Income?

```{r}
ggplot(cleaned_data, aes(x = mhi_2018, y = mcsa)) +
  geom_point(aes(color = county_fips_code)) +
  labs(title = "Scatterplot of Childcare Costs vs. Median Household Income",
       x = "Median Household Income ($)",
       y = "Average Childcare Costs ($/week)",
       color = "County Code"
    ) 
  
ggplot(cleaned_data, aes(x = mhi_2018, y = mfccsa)) +
  geom_point(aes(color = county_fips_code)) +
  labs(title = "Scatterplot of Childcare Costs vs. Median Household Income",
       x = "Median Household Income ($)",
       y = "Average Family Costs ($/week)",
       color = "County Code"
    ) 

```
This scatterplot displays the relationship between median household income and average weekly childcare costs. There is a slight positive correlation between median household income and average childcare costs.There is a similar correlation between family care and median household income, which is to be expected, as wealthier households can afford to spend more in raising their children.


```{r}
ggplot(cleaned_data, aes(x = mcsa)) +
  geom_histogram(bins = 30, fill = "blue") +
  labs(title = "Center-Based Costs Distribution",
       x = "Center-Based Costs ($/week)",
       y = "Frequency") +
  theme_minimal()

ggplot(cleaned_data, aes(x = mfccsa)) +
  geom_histogram(bins = 30, fill = "blue") +
  labs(title = "Family Costs Distribution",
       x = "Family Costs ($/week)",
       y = "Frequency") +
  theme_minimal()

```
This histogram shows the distribution of weekly childcare costs, both in center-based and family. The shape and spread of the distribution provide insights into the common cost ranges and the variability of childcare expenses. The distributions are pretty similar, with the median falling around the $100 a week range.  


```{r}
ggplot(cleaned_data, aes(x = mhi_2018)) +
  geom_boxplot() +
  labs(title = "Median Household Income",
       x = "Income") +
  theme_minimal()
```
The boxplot of median household income provides a summary of income distribution across the dataset. This gives us an image of the wealth levels of the families surveyed, with most earning an income of around $50,000, though there are a group of outliers making over $100,000

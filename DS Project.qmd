---
title: "DS Project"
author: "Lucas Rapeepat, Ian Stripe"
format: 
  html:
    toc: true
    embed-resources: true
    code-fold: true
    code-line-numbers: true
    code-summary: "SHOW ME THE CODE!"
    code-tools: true
    theme: yeti
editor: visual
---

# Introduction

In the contemporary landscape of American family life, the cost of childcare emerges as a pivotal factor influencing economic stability, parental employment, and, ultimately, child welfare. Access to affordable, quality childcare has been linked to a range of positive outcomes, including increased workforce participation, particularly among women, and enhanced child development. Yet, for many families across the United States, childcare remains a significant financial burden, absorbing a disproportionate share of household income. This project seeks to illuminate the complexities surrounding childcare costs, shedding light on their variability across different geographical regions and over time.

This analysis is anchored in data drawn from the National Database of Childcare Prices, the most comprehensive federal repository of childcare price information at the county level. Spanning from 2008 to 2018, this database offers a granular look at childcare costs across various dimensions: by provider type, the age of children, and county characteristics. The project utilizes two primary data sets: childcare_costs.csv, containing detailed childcare price data, and counties.csv, which provides a suite of county-level attributes. These datasets are unified through the county_fips_code, enabling a holistic examination of how childcare costs correlate with a myriad of socioeconomic factors.

The goal of this project is not merely to chart the ebb and flow of childcare expenses but to understand the broader implications of these costs on families and communities. By employing a robust analytical framework, this study will explore several key questions: How have childcare costs evolved over the last decade? Do these costs exhibit significant variability across states or regions? What socioeconomic variables—such as unemployment rates, median household income, or racial composition—interact most dynamically with childcare expenses?

The answers to these questions promise not only to advance our understanding of childcare economics but also to inform policy discussions aimed at making quality childcare more accessible and affordable. Through a meticulous analysis of available data, this project endeavors to contribute a meaningful voice to the ongoing dialogue about how best to support American families in balancing the demands of work and child-rearing.














# Step 2

```{r}
#Set-up
#| message: false
#| warning: false
library(tidyverse)
```



## Data Pre-Processing

Our journey through data analysis began with a structured approach to preparing our datasets, childcare_costs.csv and counties.csv, for comprehensive exploration. This preparation involved a series of steps aimed at refining and integrating our data, ensuring it was primed for the analyses that lay ahead. Here, we detail the practical steps taken, accompanied by the R code used to execute these operations.

Initial Data Inspection
Before delving into the pre-processing steps, we initiated our exploration by loading and inspecting the datasets to understand their structure:

### Loading the datasets
```{r}
childcare_costs <- read.csv("C:/Users/Lucas Rapeepat/Downloads/childcare_costs.csv")
counties <- read.csv("C:/Users/Lucas Rapeepat/Downloads/counties.csv")

```

# Initial inspection to understand the structure and contents
```{r}
str(childcare_costs)
str(counties)
```
Number of Counties:
How many unique counties are available for analysis?

```{r}
counties |>
  n_distinct()
```

Joining the Datasets
Our first major step was to merge the two datasets using the county_fips_code as a key. This inner join operation ensured that we retained only those records present in both datasets, facilitating a unified analysis framework.

```{r}
# Merging the datasets on the county_fips_code
combined_data <- childcare_costs |>
  inner_join(counties, by = "county_fips_code")

```


Removing Missing Data
To enhance the reliability of our analysis, we next focused on identifying and excluding rows with missing values, particularly in critical variables such as childcare costs and county characteristics.

```{r}
# Removing rows with any missing values
cleaned_data <- combined_data |>
  drop_na()

```



Data Filtering
With a focus on our analysis timeframe (2008 to 2018) and specific variables of interest, we applied filters to refine our dataset further, ensuring relevance and focus in our analysis.

```{r}
# Example of filtering data (if specific years or conditions were needed)
# For demonstration, assuming we proceed with the full dataset as is

# cleaned_data <- cleaned_data %>%
#   filter(year >= 2008 & year <= 2018)

```



Creation of New Variables
To facilitate deeper insights and enable more nuanced analyses, we derived new variables from our existing data, such as categorizations based on socio-economic indicators.

```{r}
# Example of creating a new variable (categorizing counties by median income)
# For demonstration, assuming no new variables were created at this step

# cleaned_data <- cleaned_data %>%
#   mutate(income_category = cut(median_household_income, 
#                                breaks = quantile(median_household_income, 
#                                                   probs = 0:5 / 5, na.rm = TRUE),
#                                include.lowest = TRUE))

```


Final Dataset Dimensions
After these steps, we examined the dimensions of our final dataset to confirm the scope of our analysis base:

```{r}
nrow(cleaned_data)
ncol(cleaned_data)
dim(cleaned_data)
```


# Section 3


Did childcare costs (by age group) on average change over time from 2008 to 2018?
```{r}
cost_trends <- cleaned_data |>
  select(study_year, mc_infant, mc_toddler, mc_preschool) |>
  group_by(study_year) |>
  summarize(across(starts_with("mc"), mean, na.rm = TRUE))

ggplot(cost_trends, aes(x = study_year)) +
  geom_line(aes(y = mc_infant, color = "Infant")) +
  geom_line(aes(y = mc_toddler, color = "Toddler")) +
  geom_line(aes(y = mc_preschool, color = "Preschool")) +
  labs(title = "Childcare Costs Trends from 2008 to 2018",
       x = "Year",
       y = "Average Cost",
       color = "Age Group")
```



Did childcare costs differ by state (on average)?

```{r}
state_costs <- cleaned_data |>
  group_by(state_name) |>
  summarize(across(starts_with("mc"), mean, na.rm = TRUE))

state_costs

```
How were childcare costs related by race?

```{r}


library(dplyr)

# Calculate weighted averages for each race and childcare type
race_weighted_costs <- cleaned_data |>
  summarize(
    white_infant = weighted.mean(mc_infant, one_race_w, na.rm = TRUE),
    black_infant = weighted.mean(mc_infant, one_race_b, na.rm = TRUE),
    ai_an_infant = weighted.mean(mc_infant, one_race_i, na.rm = TRUE),
    asian_infant = weighted.mean(mc_infant, one_race_a, na.rm = TRUE),
    nh_pi_infant = weighted.mean(mc_infant, one_race_h, na.rm = TRUE),
    other_infant = weighted.mean(mc_infant, one_race_other, na.rm = TRUE),

    white_toddler = weighted.mean(mc_toddler, one_race_w, na.rm = TRUE),
    black_toddler = weighted.mean(mc_toddler, one_race_b, na.rm = TRUE),
    ai_an_toddler = weighted.mean(mc_toddler, one_race_i, na.rm = TRUE),
    asian_toddler = weighted.mean(mc_toddler, one_race_a, na.rm = TRUE),
    nh_pi_toddler = weighted.mean(mc_toddler, one_race_h, na.rm = TRUE),
    other_toddler = weighted.mean(mc_toddler, one_race_other, na.rm = TRUE),

    white_preschool = weighted.mean(mc_preschool, one_race_w, na.rm = TRUE),
    black_preschool = weighted.mean(mc_preschool, one_race_b, na.rm = TRUE),
    ai_an_preschool = weighted.mean(mc_preschool, one_race_i, na.rm = TRUE),
    asian_preschool = weighted.mean(mc_preschool, one_race_a, na.rm = TRUE),
    nh_pi_preschool = weighted.mean(mc_preschool, one_race_h, na.rm = TRUE),
    other_preschool = weighted.mean(mc_preschool, one_race_other, na.rm = TRUE)
  )

# Transform data to have races as rows and childcare cost denominations as columns
race_weighted_costs_long <- race_weighted_costs |>
  pivot_longer(
    everything(),
    names_to = c(".value", "childcare_type"),
    names_pattern = "(.*)_(.*)"
  )
  

race_weighted_costs_long


```

Comparison of Family Care vs Center-Based

```{r}

# Calculate the average costs for center-based and family childcare for each age group
care_cost_comparison <- cleaned_data |>
  summarize(
    avg_center_infant = mean(mc_infant, na.rm = TRUE),
    avg_family_infant = mean(mfcc_infant, na.rm = TRUE),
    avg_center_toddler = mean(mc_toddler, na.rm = TRUE),
    avg_family_toddler = mean(mfcc_toddler, na.rm = TRUE),
    avg_center_preschool = mean(mc_preschool, na.rm = TRUE),
    avg_family_preschool = mean(mfcc_preschool, na.rm = TRUE)
  ) 

care_cost_comparison

```





